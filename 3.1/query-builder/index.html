
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Kotlin Multiplatform library for Couchbase Liteâ€”a lightweight, embedded, syncable, NoSQL database">
      
      
        <meta name="author" content="Jeff Lockhart">
      
      
        <link rel="canonical" href="https://kotbase.dev/current/query-builder/">
      
      
        <link rel="prev" href="../blobs/">
      
      
        <link rel="next" href="../n1ql-query-strings/">
      
      
      <link rel="icon" href="../assets/images/logo-icon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>QueryBuilder - Kotbase</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--link:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>');--md-admonition-icon--important:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 6a6 6 0 0 1 6 6c0 2.22-1.21 4.16-3 5.2V19a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-1.8c-1.79-1.04-3-2.98-3-5.2a6 6 0 0 1 6-6m2 15v1a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-1zm6-10h3v2h-3zM1 11h3v2H1zM13 1v3h-2V1zM4.92 3.5l2.13 2.14-1.42 1.41L3.5 4.93zm12.03 2.13 2.12-2.13 1.43 1.43-2.13 2.12z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=DM+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"DM Sans";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/permalink.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-QFS8SG5ZKD"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-QFS8SG5ZKD",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-QFS8SG5ZKD",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Kotbase" class="md-header__button md-logo" aria-label="Kotbase" data-md-component="logo">
      
  <img src="../assets/images/logo-icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kotbase
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              QueryBuilder
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jeffdgr8/kotbase" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Kotbase
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../installation/" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../databases/" class="md-tabs__link">
          
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../api" target="_blank" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Kotbase" class="md-nav__button md-logo" aria-label="Kotbase" data-md-component="logo">
      
  <img src="../assets/images/logo-icon.svg" alt="logo">

    </a>
    Kotbase
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jeffdgr8/kotbase" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Kotbase
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kotbase
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../differences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differences from Java SDK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change Log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Community
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../platforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supported Platforms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build and Run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Extension Libraries
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Extension Libraries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ktx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KTX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kermit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kermit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Paging
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../databases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prebuilt-database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre-built Database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scopes-and-collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scopes and Collections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Query
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Query
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    QueryBuilder
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    QueryBuilder
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-statement" class="md-nav__link">
    <span class="md-ellipsis">
      SELECT statement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SELECT statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#return-all-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Return All Properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-selected-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Return Selected Properties
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-statement" class="md-nav__link">
    <span class="md-ellipsis">
      WHERE statement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WHERE statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comparison-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collection-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Collection Operators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Collection Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contains-operator" class="md-nav__link">
    <span class="md-ellipsis">
      CONTAINS Operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-operator" class="md-nav__link">
    <span class="md-ellipsis">
      IN Operator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#like-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Like Operator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Like Operator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-matching" class="md-nav__link">
    <span class="md-ellipsis">
      String Matching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildcard-match" class="md-nav__link">
    <span class="md-ellipsis">
      Wildcard Match
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildcard-character-match" class="md-nav__link">
    <span class="md-ellipsis">
      Wildcard Character Match
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regex-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Regex Operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleted-document" class="md-nav__link">
    <span class="md-ellipsis">
      Deleted Document
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join-statement" class="md-nav__link">
    <span class="md-ellipsis">
      JOIN statement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#group-by-statement" class="md-nav__link">
    <span class="md-ellipsis">
      GROUP BY statement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#order-by-statement" class="md-nav__link">
    <span class="md-ellipsis">
      ORDER BY statement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datetime-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Date/Time Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#result-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Result Sets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result Sets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#processing" class="md-nav__link">
    <span class="md-ellipsis">
      Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-all-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Select All Properties
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select All Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-specific-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Select Specific Properties
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select Specific Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query_1" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format_1" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access_1" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-document-id-only" class="md-nav__link">
    <span class="md-ellipsis">
      Select Document ID Only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select Document ID Only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query_2" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format_2" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access_2" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-count-only" class="md-nav__link">
    <span class="md-ellipsis">
      Select Count-only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select Count-only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query_3" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format_3" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access_3" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      Handling Pagination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-result-sets" class="md-nav__link">
    <span class="md-ellipsis">
      JSON Result Sets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JSON Result Sets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json-string-format" class="md-nav__link">
    <span class="md-ellipsis">
      JSON String Format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predictive-query" class="md-nav__link">
    <span class="md-ellipsis">
      Predictive Query
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Predictive Query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#integrate-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Integrate the Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Register the Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-an-index" class="md-nav__link">
    <span class="md-ellipsis">
      Create an Index
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create an Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#value-index" class="md-nav__link">
    <span class="md-ellipsis">
      Value Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictive-index" class="md-nav__link">
    <span class="md-ellipsis">
      Predictive Index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-a-prediction-query" class="md-nav__link">
    <span class="md-ellipsis">
      Run a Prediction Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deregister-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Deregister the Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../n1ql-query-strings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL++ Query Strings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../n1ql-server-differences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL++ Server Differences
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../n1ql-query-builder-differences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL++ QueryBuilder Differences
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../query-result-sets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Result Sets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../live-queries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Live Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../query-troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../full-text-search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Full Text Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../indexing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Sync
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Data Sync
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../remote-sync-gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote Sync Gateway
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intra-device-sync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intra-device Sync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9_3" >
        
          
          <label class="md-nav__link" for="__nav_3_9_3" id="__nav_3_9_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Peer-to-Peer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9_3">
            <span class="md-nav__icon md-icon"></span>
            Peer-to-Peer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../peer-to-peer-sync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Peer-to-Peer Sync
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../passive-peer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passive Peer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../active-peer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Active Peer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrate-custom-listener/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrate Custom Listener
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handling-data-conflicts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Handling Data Conflicts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kotlin-extensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kotlin Extensions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api" target="_blank" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-statement" class="md-nav__link">
    <span class="md-ellipsis">
      SELECT statement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SELECT statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#return-all-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Return All Properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-selected-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Return Selected Properties
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-statement" class="md-nav__link">
    <span class="md-ellipsis">
      WHERE statement
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WHERE statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comparison-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collection-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Collection Operators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Collection Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contains-operator" class="md-nav__link">
    <span class="md-ellipsis">
      CONTAINS Operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-operator" class="md-nav__link">
    <span class="md-ellipsis">
      IN Operator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#like-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Like Operator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Like Operator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string-matching" class="md-nav__link">
    <span class="md-ellipsis">
      String Matching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildcard-match" class="md-nav__link">
    <span class="md-ellipsis">
      Wildcard Match
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wildcard-character-match" class="md-nav__link">
    <span class="md-ellipsis">
      Wildcard Character Match
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regex-operator" class="md-nav__link">
    <span class="md-ellipsis">
      Regex Operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleted-document" class="md-nav__link">
    <span class="md-ellipsis">
      Deleted Document
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join-statement" class="md-nav__link">
    <span class="md-ellipsis">
      JOIN statement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#group-by-statement" class="md-nav__link">
    <span class="md-ellipsis">
      GROUP BY statement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#order-by-statement" class="md-nav__link">
    <span class="md-ellipsis">
      ORDER BY statement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datetime-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Date/Time Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#result-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Result Sets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result Sets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#processing" class="md-nav__link">
    <span class="md-ellipsis">
      Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-all-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Select All Properties
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select All Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-specific-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Select Specific Properties
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select Specific Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query_1" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format_1" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access_1" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-document-id-only" class="md-nav__link">
    <span class="md-ellipsis">
      Select Document ID Only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select Document ID Only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query_2" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format_2" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access_2" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-count-only" class="md-nav__link">
    <span class="md-ellipsis">
      Select Count-only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Select Count-only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query_3" class="md-nav__link">
    <span class="md-ellipsis">
      Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-format_3" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-set-access_3" class="md-nav__link">
    <span class="md-ellipsis">
      Result Set Access
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      Handling Pagination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-result-sets" class="md-nav__link">
    <span class="md-ellipsis">
      JSON Result Sets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JSON Result Sets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json-string-format" class="md-nav__link">
    <span class="md-ellipsis">
      JSON String Format
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#predictive-query" class="md-nav__link">
    <span class="md-ellipsis">
      Predictive Query
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Predictive Query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#integrate-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Integrate the Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Register the Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-an-index" class="md-nav__link">
    <span class="md-ellipsis">
      Create an Index
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create an Index">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#value-index" class="md-nav__link">
    <span class="md-ellipsis">
      Value Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictive-index" class="md-nav__link">
    <span class="md-ellipsis">
      Predictive Index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-a-prediction-query" class="md-nav__link">
    <span class="md-ellipsis">
      Run a Prediction Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deregister-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Deregister the Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>QueryBuilder</h1>

<p><em>How to use <code>QueryBuilder</code> to build effective queries with Kotbase</em></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The examples used here are based on the <em>Travel Sample</em> app and data introduced in the <a href="https://docs.couchbase.com/tutorials/mobile-travel-tutorial/introduction.html">Couchbase Mobile Workshop</a> tutorial.</p>
</div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link"></a></h2>
<p>Kotbase provides two ways to build and run database queries; the <code>QueryBuilder</code> API described in this topic and <a href="../n1ql-query-strings/">SQL++
for Mobile</a>.</p>
<p>Database queries defined with the <code>QueryBuilder</code> API use the query statement format shown in <a href="#example-1">Example 1</a>.
The structure and semantics of the query format are based on Couchbaseâ€™s <a href="https://docs.couchbase.com/server/current/learn/data/n1ql-versus-sql.html">SQL++ query language</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-1'>Example 1. Query Format</span></p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">____</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">FROM</span><span class="w"> </span><span class="s1">&#39;data-source&#39;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">____</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">JOIN</span><span class="w"> </span><span class="n">____</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">____</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">____</span>
</span></code></pre></div>
</div>
<p><strong>Query Components</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><a href="#select-statement">SELECT statement</a></td>
<td style="text-align: left;">The document properties that will be returned in the result set</td>
</tr>
<tr>
<td style="text-align: left;">FROM</td>
<td style="text-align: left;">The data source to query the documents from â€” the collection of the database</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#where-statement">WHERE statement</a></td>
<td style="text-align: left;">The query criteria<br>The <code>SELECT</code>ed properties of documents matching this criteria will be returned in the result set</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#join-statement">JOIN statement</a></td>
<td style="text-align: left;">The criteria for joining multiple documents</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#group-by-statement">GROUP BY statement</a></td>
<td style="text-align: left;">The criteria used to group returned items in the result set</td>
</tr>
<tr>
<td style="text-align: left;"><a href="#order-by-statement">ORDER BY statement</a></td>
<td style="text-align: left;">The criteria used to order the items in the result set</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We recommend working through the query section of the <a href="https://docs.couchbase.com/tutorials/mobile-travel-tutorial/introduction.html">Couchbase Mobile Workshop</a> tutorial as a good way to build your
skills in this area.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The examples in the documentation use the official Couchbase Lite query builder APIs, available in the Kotbase core
artifacts. Many queries can take advantage of the concise <code>infix</code> function query builder APIs available in the
<a href="../ktx/#querybuilder-extensions">Kotbase KTX extensions</a>.</p>
</div>
<h2 id="select-statement">SELECT statement<a class="headerlink" href="#select-statement" title="Permanent link"></a></h2>
<p><strong>In this section</strong><br />
<a href="#return-all-properties">Return All Properties</a> | <a href="#return-selected-properties">Return Selected Properties</a>   </p>
<p><strong>Related</strong>
<a href="#result-sets">Result Sets</a></p>
<p>Use the <code>SELECT</code> statement to specify which properties you want to return from the queried documents. You can opt to
retrieve entire documents, or just the specific properties you need.</p>
<h3 id="return-all-properties">Return All Properties<a class="headerlink" href="#return-all-properties" title="Permanent link"></a></h3>
<p>Use the <code>SelectResult.all()</code> method to return all the properties of selected documents â€” see <a href="#example-2">Example 2</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-2'>Example 2. Using SELECT to Retrieve All Properties</span></p>
<p>This query shows how to retrieve all properties from all documents in a collection.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">queryAll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="n">SelectResult</span><span class="p">.</span><span class="na">all</span><span class="p">())</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;hotel&quot;</span><span class="p">)))</span>
</span></code></pre></div>
</div>
<p>The <code>Query.execute()</code> statement returns the results in a dictionary, where the key is the database name â€” see <a href="#example-3">Example
3</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-3'>Example 3. ResultSet Format from SelectResult.all()</span></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">[</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="nt">&quot;travel-sample&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the first document matching the query criteria.</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">      </span><span class="nt">&quot;callsign&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MILE-AIR&quot;</span><span class="p">,</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">      </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;United States&quot;</span><span class="p">,</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">      </span><span class="nt">&quot;iata&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Q5&quot;</span><span class="p">,</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">      </span><span class="nt">&quot;icao&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLA&quot;</span><span class="p">,</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;40-Mile Air&quot;</span><span class="p">,</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;airline&quot;</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">    </span><span class="nt">&quot;travel-sample&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the next document matching the query criteria.</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">      </span><span class="nt">&quot;callsign&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ALASKAN-AIR&quot;</span><span class="p">,</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">      </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;United States&quot;</span><span class="p">,</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="w">      </span><span class="nt">&quot;iata&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AA&quot;</span><span class="p">,</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="w">      </span><span class="nt">&quot;icao&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alaskan Airways&quot;</span><span class="p">,</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;airline&quot;</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="p">]</span>
</span></code></pre></div>
</div>
<p>See <a href="#result-sets">Result Sets</a> for more on processing query results.</p>
<h3 id="return-selected-properties">Return Selected Properties<a class="headerlink" href="#return-selected-properties" title="Permanent link"></a></h3>
<p>To access only specific properties, specify a comma-separated list of <code>SelectResult</code> expressions, one for each property,
in the select statement of your query â€” see <a href="#example-4">Example 4</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-4'>Example 4. Using SELECT to Retrieve Specific Properties</span></p>
<p>In this query we retrieve and then print the <code>_id</code>, <code>type</code>, and <code>name</code> properties of each document.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">),</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;hotel&quot;</span><span class="p">)))</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="n">Ordering</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">))</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;hotel id -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">id</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;hotel name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<p>The <code>Query.execute()</code> statement returns one or more key-value pairs, one for each <code>SelectResult</code> expression, with the
property-name as the key â€” see <a href="#example-5">Example 5</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-5'>Example 5. Select Result Format</span></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">[</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the first document matching the query criteria.</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel123&quot;</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel&quot;</span><span class="p">,</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hotel Ghia&quot;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the next document matching the query criteria.</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel456&quot;</span><span class="p">,</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel&quot;</span><span class="p">,</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hotel Deluxe&quot;</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="p">]</span>
</span></code></pre></div>
</div>
<p>See <a href="#result-sets">Result Sets</a> for more on processing query results.</p>
<h2 id="where-statement">WHERE statement<a class="headerlink" href="#where-statement" title="Permanent link"></a></h2>
<p><strong>In this section</strong><br />
<a href="#comparison-operators">Comparison Operators</a> | <a href="#collection-operators">Collection Operators</a> | <a href="#like-operator">Like
Operator</a> | <a href="#regex-operator">Regex Operator</a> | <a href="#deleted-document">Deleted Document</a></p>
<p>Like SQL, you can use the <code>WHERE</code> statement to choose which documents are returned by your query. The <code>where()</code>
statement takes in an <code>Expression</code>. You can chain any number of <code>Expression</code>s in order to implement sophisticated
filtering capabilities.</p>
<h3 id="comparison-operators">Comparison Operators<a class="headerlink" href="#comparison-operators" title="Permanent link"></a></h3>
<p>The <a href="/api/couchbase-lite-ee/kotbase/-expression/"><code>Expression</code> Comparators</a> can be used in the <code>WHERE</code> statement to
specify on which property to match documents. In the example below, we use the <code>equalTo</code> operator to query documents
where the <code>type</code> property equals "hotel".</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="p">[</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel123&quot;</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel&quot;</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hotel Ghia&quot;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel456&quot;</span><span class="p">,</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel&quot;</span><span class="p">,</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hotel Deluxe&quot;</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="p">]</span>
</span></code></pre></div>
<div class="admonition example">
<p class="admonition-title">Example 6. Using Where</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="n">SelectResult</span><span class="p">.</span><span class="na">all</span><span class="p">())</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;hotel&quot;</span><span class="p">)))</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="p">.</span><span class="na">limit</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">intValue</span><span class="p">(</span><span class="m">10</span><span class="p">))</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">        </span><span class="n">result</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="s">&quot;myDatabase&quot;</span><span class="p">)</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;type -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">type</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h3 id="collection-operators">Collection Operators<a class="headerlink" href="#collection-operators" title="Permanent link"></a></h3>
<p><a href="/api/couchbase-lite-ee/kotbase/-array-function/"><code>ArrayFunction</code> Collection Operators</a> are useful to check if a given
value is present in an array.</p>
<h4 id="contains-operator">CONTAINS Operator<a class="headerlink" href="#contains-operator" title="Permanent link"></a></h4>
<p>The following example uses the <a href="/api/couchbase-lite-ee/kotbase/-array-function/"><code>ArrayFunction</code></a> to find documents
where the <code>public_likes</code> array property contains a value equal to "Armani Langworth".</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">{</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel123&quot;</span><span class="p">,</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Apple Droid&quot;</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="nt">&quot;public_likes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Armani Langworth&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Elfrieda Gutkowski&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Maureen Ruecker&quot;</span><span class="p">]</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition example">
<p class="admonition-title">Example 7. Using the CONTAINS operator</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">),</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;public_likes&quot;</span><span class="p">)</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;hotel&quot;</span><span class="p">))</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">                </span><span class="n">ArrayFunction</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">                    </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;public_likes&quot;</span><span class="p">),</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">                    </span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;Armani Langworth&quot;</span><span class="p">)</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">                </span><span class="p">)</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;public_likes -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getArray</span><span class="p">(</span><span class="s">&quot;</span><span class="n">public_likes</span><span class="s">&quot;</span><span class="p">)</span><span class="o">?.</span><span class="na">toList</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h4 id="in-operator">IN Operator<a class="headerlink" href="#in-operator" title="Permanent link"></a></h4>
<p>The <code>IN</code> operator is useful when you need to explicitly list out the values to test against. The following example looks
for documents whose <code>first</code>, <code>last</code>, or <code>username</code> property value equals "Armani".</p>
<div class="admonition example">
<p class="admonition-title">Example 8. Using the IN operator</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="n">SelectResult</span><span class="p">.</span><span class="na">all</span><span class="p">())</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;Armani&quot;</span><span class="p">).</span><span class="n">`in`</span><span class="p">(</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">            </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;first&quot;</span><span class="p">),</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">            </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;last&quot;</span><span class="p">),</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">            </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;username&quot;</span><span class="p">)</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">        </span><span class="p">)</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;public_likes -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">toMap</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h3 id="like-operator">Like Operator<a class="headerlink" href="#like-operator" title="Permanent link"></a></h3>
<p><strong>In this section</strong><br />
<a href="#string-matching">String Matching</a> | <a href="#wildcard-match">Wildcard Match</a> | <a href="#wildcard-character-match">Wildcard Character Match</a></p>
<h4 id="string-matching">String Matching<a class="headerlink" href="#string-matching" title="Permanent link"></a></h4>
<p>The <a href="/api/couchbase-lite-ee/kotbase/-expression/like.html"><code>like()</code></a> operator can be used for string matching â€” see
<a href="#example-9">Example 9</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>like</code> operator performs case sensitive matches.<br />
To perform case insensitive matching, use <code>Function.lower</code> or <code>Function.upper</code> to ensure all comparators have the
same case, thereby removing the case issue.</p>
</div>
<p>This query returns <code>landmark</code> type documents where the <code>name</code> matches the string "Royal Engineers Museum", regardless of
how it is capitalized (so, it selects "royal engineers museum", "ROYAL ENGINEERS MUSEUM" and so on).</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-9'>Example 9. Like with case-insensitive matching</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;landmark&quot;</span><span class="p">))</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">                </span><span class="n">Function</span><span class="p">.</span><span class="na">lower</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">))</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">                    </span><span class="p">.</span><span class="na">like</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;royal engineers museum&quot;</span><span class="p">))</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<p><strong>Note</strong> the use of <code>Function.lower()</code> to transform <code>name</code> values to the same case as the literal comparator.</p>
<h4 id="wildcard-match">Wildcard Match<a class="headerlink" href="#wildcard-match" title="Permanent link"></a></h4>
<p>We can use <code>%</code> sign within a <code>like</code> expression to do a wildcard match against zero or more characters. Using wildcards
allows you to have some fuzziness in your search string.</p>
<p>In <a href="#example-10">Example 10</a> below, we are looking for documents of <code>type</code> "landmark" where the name property matches any
string that begins with "eng" followed by zero or more characters, the letter "e", followed by zero or more characters.
Once again, we are using <code>Function.lower()</code> to make the search case-insensitive.</p>
<p>So the query returns "landmark" documents with names such as "Engineers", "engine", "english egg" and "England Eagle".
Notice that the matches may span word boundaries.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-10'>Example 10. Wildcard Matches</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;landmark&quot;</span><span class="p">))</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">                </span><span class="n">Function</span><span class="p">.</span><span class="na">lower</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">))</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">                    </span><span class="p">.</span><span class="na">like</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;eng%e%&quot;</span><span class="p">))</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h4 id="wildcard-character-match">Wildcard Character Match<a class="headerlink" href="#wildcard-character-match" title="Permanent link"></a></h4>
<p>We can use an <code>_</code> sign within a <code>like</code> expression to do a wildcard match against a single character.</p>
<p>In <a href="#example-11">Example 11</a> below, we are looking for documents of type "landmark" where the <code>name</code> property matches any
string that begins with "eng" followed by exactly 4 wildcard characters and ending in the letter "r". The query returns
"landmark" type documents with names such as "Engineer", "engineer" and so on.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-11'>Example 11. Wildcard Character Matching</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;landmark&quot;</span><span class="p">))</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">                </span><span class="n">Function</span><span class="p">.</span><span class="na">lower</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">))</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">                    </span><span class="p">.</span><span class="na">like</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;eng____r&quot;</span><span class="p">))</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h3 id="regex-operator">Regex Operator<a class="headerlink" href="#regex-operator" title="Permanent link"></a></h3>
<p>Similar to the wildcards in <code>like</code> expressions, <code>regex</code> based pattern matching allow you to introduce an element of
fuzziness in your search string â€” see the code shown in <a href="#example-12">Example 12</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>regex</code> operator is case sensitive, use <code>upper</code> or <code>lower</code> functions to mitigate this if required.</p>
</div>
<div class="admonition example">
<p class="admonition-title"><span id='example-12'>Example 12. Using Regular Expressions</span></p>
<p>This example returns documents with a <code>type</code> of "landmark" and a <code>name</code> property that matches any string that begins
with "eng" and ends in the letter "e".</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;landmark&quot;</span><span class="p">))</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">                </span><span class="n">Function</span><span class="p">.</span><span class="na">lower</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">))</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">                    </span><span class="p">.</span><span class="na">regex</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;\\beng.*r\\b&quot;</span><span class="p">))</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="p">}</span>
</span></code></pre></div>
<p>The <code>\b</code> specifies that the match must occur on word boundaries.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For more on the regex spec used by Couchbase Lite see <a href="http://www.cplusplus.com/reference/regex/ECMAScript/">cplusplus regex reference page</a>.</p>
</div>
<h3 id="deleted-document">Deleted Document<a class="headerlink" href="#deleted-document" title="Permanent link"></a></h3>
<p>You can query documents that have been deleted (tombstones) as shown in <a href="#example-13">Example 13</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-13'>Example 13. Query to select Deleted Documents</span></p>
<p>This example shows how to query deleted documents in the database. It returns is an array of key-value pairs.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">// Query documents that have been deleted</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">))</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">deleted</span><span class="p">)</span>
</span></code></pre></div>
</div>
<h2 id="join-statement">JOIN statement<a class="headerlink" href="#join-statement" title="Permanent link"></a></h2>
<p>The <code>JOIN</code> clause enables you to select data from multiple documents that have been linked by criteria specified in the
<code>JOIN</code> statement. For example to combine airline details with route details, linked by the airline id â€” see <a href="#example-14">Example 14
</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-14'>Example 14. Using JOIN to Combine Document Details</span></p>
<p>This example JOINS the document of <code>type</code> "route" with documents of <code>type</code> "airline" using the document ID (<code>_id</code>)
on the <em>airline</em> document and <code>airlineid</code> on the <em>route</em> document.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;airline&quot;</span><span class="p">)),</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;callsign&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;airline&quot;</span><span class="p">)),</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;destinationairport&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">)),</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;stops&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">)),</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;airline&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">))</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">airlineCollection</span><span class="p">).</span><span class="n">`as`</span><span class="p">(</span><span class="s">&quot;airline&quot;</span><span class="p">))</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span><span class="p">.</span><span class="na">join</span><span class="p">(</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">        </span><span class="n">Join</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">routeCollection</span><span class="p">).</span><span class="n">`as`</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">))</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">            </span><span class="p">.</span><span class="na">on</span><span class="p">(</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">                </span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;airline&quot;</span><span class="p">)</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">                    </span><span class="p">.</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;airlineid&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">))</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">))</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w">                </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;airline&quot;</span><span class="p">)</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">                    </span><span class="p">.</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;airline&quot;</span><span class="p">))</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="w">                </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;sourceairport&quot;</span><span class="p">).</span><span class="na">from</span><span class="p">(</span><span class="s">&quot;route&quot;</span><span class="p">)</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="w">                    </span><span class="p">.</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;RIX&quot;</span><span class="p">))</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">toMap</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h2 id="group-by-statement">GROUP BY statement<a class="headerlink" href="#group-by-statement" title="Permanent link"></a></h2>
<p>You can perform further processing on the data in your result set before the final projection is generated.</p>
<p>The following example looks for the number of airports at an altitude of 300 ft or higher and groups the results by
country and timezone.</p>
<div class="language-json highlight"><span class="filename">Data Model for Example</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="p">{</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;airport123&quot;</span><span class="p">,</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;airport&quot;</span><span class="p">,</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;United States&quot;</span><span class="p">,</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="nt">&quot;geo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;alt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">456</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="nt">&quot;tz&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;America/Anchorage&quot;</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="p">}</span>
</span></code></pre></div>
<div class="admonition example">
<p class="admonition-title"><span id='example-15'>Example 15. Query using GroupBy</span></p>
<p>This example shows a query that selects all airports with an altitude above 300ft. The output (a count, $1) is
grouped by country, within timezone.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Function</span><span class="p">.</span><span class="na">count</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">))),</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;tz&quot;</span><span class="p">)</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;airport&quot;</span><span class="p">))</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;geo.alt&quot;</span><span class="p">).</span><span class="na">greaterThanOrEqualTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">intValue</span><span class="p">(</span><span class="m">300</span><span class="p">)))</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="w">    </span><span class="p">.</span><span class="na">groupBy</span><span class="p">(</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;tz&quot;</span><span class="p">)</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="w">    </span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="n">Ordering</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Function</span><span class="p">.</span><span class="na">count</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">))).</span><span class="na">descending</span><span class="p">())</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a><span class="w">            </span><span class="s">&quot;There are </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;</span><span class="err">$</span><span class="m">1</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s"> airports on the </span><span class="si">${</span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="w">                </span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">tz</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="w">            </span><span class="si">}</span><span class="s"> timezone located in </span><span class="si">${</span>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="w">                </span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">country</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="w">            </span><span class="si">}</span><span class="s"> and above 300ft&quot;</span>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="w">        </span><span class="p">)</span>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<p>The query shown in <a href="#example-15">Example 15</a> generates the following output:</p>
<blockquote>
<p>There are 138 airports on the Europe/Paris timezone located in France and above 300 ft<br />
There are 29 airports on the Europe/London timezone located in United Kingdom and above 300 ft<br />
There are 50 airports on the America/Anchorage timezone located in United States and above 300 ft<br />
There are 279 airports on the America/Chicago timezone located in United States and above 300 ft<br />
There are 123 airports on the America/Denver timezone located in United States and above 300 ft</p>
</blockquote>
<h2 id="order-by-statement">ORDER BY statement<a class="headerlink" href="#order-by-statement" title="Permanent link"></a></h2>
<p>It is possible to sort the results of a query based on a given expression result â€” see <a href="#example-16">Example 16</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-16'>Example 16. Query using OrderBy</span></p>
<p>This example shows a query that returns documents of <code>type</code> equal to "hotel" sorted in ascending order by the value
of the <code>title</code> property.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;hotel&quot;</span><span class="p">)))</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="p">.</span><span class="na">orderBy</span><span class="p">(</span><span class="n">Ordering</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="na">ascending</span><span class="p">())</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">    </span><span class="p">.</span><span class="na">limit</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">intValue</span><span class="p">(</span><span class="m">10</span><span class="p">))</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;</span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">toMap</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<p>The query shown in <a href="#example-16">Example 16</a> generates the following output:</p>
<blockquote>
<p>Aberdyfi<br />
Achiltibuie<br />
Altrincham<br />
Ambleside<br />
Annan<br />
ArdÃ¨che<br />
Armagh<br />
Avignon</p>
</blockquote>
<h2 id="datetime-functions">Date/Time Functions<a class="headerlink" href="#datetime-functions" title="Permanent link"></a></h2>
<p>Couchbase Lite documents support a date type that internally stores dates in ISO 8601 with the GMT/UTC timezone.</p>
<p>Couchbase Liteâ€™s Query Builder API includes four functions for date comparisons.</p>
<p><code>Function.stringToMillis(Expression.property("date_time"))</code><br />
The input to this will be a validly formatted ISO 8601 <code>date_time</code> string. The end result will be an expression (with a
numeric content) that can be further input into the query builder.</p>
<p><code>Function.stringToUTC(Expression.property("date_time"))</code><br />
The input to this will be a validly formatted ISO 8601 <code>date_time</code> string. The end result will be an expression (with
string content) that can be further input into the query builder.</p>
<p><code>Function.millisToString(Expression.property("date_time"))</code><br />
The input for this is a numeric value representing milliseconds since the Unix epoch. The end result will be an
expression (with string content representing the date and time as an ISO 8601 string in the deviceâ€™s timezone) that can
be further input into the query builder.</p>
<p><code>Function.millisToUTC(Expression.property("date_time"))</code><br />
The input for this is a numeric value representing milliseconds since the Unix epoch. The end result will be an
expression (with string content representing the date and time as a UTC ISO 8601 string) that can be further input into
the query builder.</p>
<h2 id="result-sets">Result Sets<a class="headerlink" href="#result-sets" title="Permanent link"></a></h2>
<p><strong>In this section</strong><br />
<a href="#processing">Processing</a> | <a href="#select-all-properties">Select All Properties</a> | <a href="#select-specific-properties">Select Specific
Properties</a> | <a href="#select-document-id-only">Select Document ID Only</a> | <a href="#select-count-only">Select
Count-only</a> | <a href="#handling-pagination">Handling Pagination</a></p>
<h3 id="processing">Processing<a class="headerlink" href="#processing" title="Permanent link"></a></h3>
<p>This section shows how to handle the returned result sets for different types of <code>SELECT</code> statements.</p>
<p>The result set format and its handling varies slightly depending on the type of <code>SelectResult</code> statements used. The
result set formats you may encounter include those generated by:</p>
<ul>
<li><code>SelectResult.all()</code> â€” see <a href="#select-all-properties">All Properties</a></li>
<li><code>SelectResult.property("name")</code> â€” see <a href="#select-specific-properties">Specific Properties</a></li>
<li><code>SelectResult.expression(Meta.id)</code> â€” Metadata (such as the <code>_id</code>) â€” see <a href="#select-document-id-only">Document ID Only</a></li>
<li><code>SelectResult.expression(Function.count(Expression.all())).as("mycount")</code> â€” see <a href="#select-count-only">Select
  Count-only</a></li>
</ul>
<p>To process the results of a query, you first need to execute it using <code>Query.execute()</code>.</p>
<p>The execution of a Kotbase database query typically returns an array of results, a result set.</p>
<ul>
<li>The result set of an aggregate, count-only, query is a key-value pair â€” see <a href="#select-count-only">Select Count-only</a> â€”
  which you can access using the count name as its key.</li>
<li>The result set of a query returning document properties is an array.<br />
  Each array row represents the data from a document that matched your search criteria (the <code>WHERE</code> statements). The
  composition of each row is determined by the combination of <code>SelectResult</code> expressions provided in the <code>SELECT</code>
  statement. To unpack these result sets you need to iterate this array.</li>
</ul>
<h3 id="select-all-properties">Select All Properties<a class="headerlink" href="#select-all-properties" title="Permanent link"></a></h3>
<h4 id="query">Query<a class="headerlink" href="#query" title="Permanent link"></a></h4>
<p>The <code>Select</code> statement for this type of query, returns all document properties for each document matching the query
criteria â€” see <a href="#example-17">Example 17</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-17'>Example 17. Query selecting All Properties</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="n">SelectResult</span><span class="p">.</span><span class="na">all</span><span class="p">())</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span></code></pre></div>
</div>
<h4 id="result-set-format">Result Set Format<a class="headerlink" href="#result-set-format" title="Permanent link"></a></h4>
<p>The result set returned by queries using <code>SelectResult.all()</code> is an array of dictionary objects â€” one for each document
matching the query criteria.</p>
<p>For each result object, the key is the database name and the value is a dictionary representing each document property
as a key-value pair â€” see <a href="#example-18">Example 18</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-18'>Example 18. Format of Result Set (All Properties)</span></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p">[</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="nt">&quot;travel-sample&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the first document matching the query criteria.</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">      </span><span class="nt">&quot;callsign&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MILE-AIR&quot;</span><span class="p">,</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">      </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;United States&quot;</span><span class="p">,</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">      </span><span class="nt">&quot;iata&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Q5&quot;</span><span class="p">,</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">      </span><span class="nt">&quot;icao&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MLA&quot;</span><span class="p">,</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;40-Mile Air&quot;</span><span class="p">,</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;airline&quot;</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">    </span><span class="nt">&quot;travel-sample&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the next document matching the query criteria.</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">      </span><span class="nt">&quot;callsign&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ALASKAN-AIR&quot;</span><span class="p">,</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">      </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;United States&quot;</span><span class="p">,</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">      </span><span class="nt">&quot;iata&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AA&quot;</span><span class="p">,</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">      </span><span class="nt">&quot;icao&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alaskan Airways&quot;</span><span class="p">,</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;airline&quot;</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="p">]</span>
</span></code></pre></div>
</div>
<h4 id="result-set-access">Result Set Access<a class="headerlink" href="#result-set-access" title="Permanent link"></a></h4>
<p>In this case access the retrieved document properties by converting each rowâ€™s value, in turn, to a dictionary â€” as
shown in <a href="#example-19">Example 19</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-19'>Example 19. Using Document Properties (All)</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">hotels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mutableMapOf</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">Hotel</span><span class="o">&gt;</span><span class="p">()</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">allResults</span><span class="p">().</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">        </span><span class="c1">// get the k-v pairs from the &#39;hotel&#39; key&#39;s value into a dictionary</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">docProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">docId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">docProps</span><span class="o">!!</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">docName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">docProps</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">docType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">docProps</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">docCity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">docProps</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;city&quot;</span><span class="p">)</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">        </span><span class="c1">// Alternatively, access results value dictionary directly</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span><span class="o">!!</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">        </span><span class="n">hotels</span><span class="o">[</span><span class="n">id</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hotel</span><span class="p">(</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">            </span><span class="n">id</span><span class="p">,</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="w">            </span><span class="nb">it</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">),</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="w">            </span><span class="nb">it</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">),</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="w">            </span><span class="nb">it</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;city&quot;</span><span class="p">),</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="w">            </span><span class="nb">it</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="w">            </span><span class="nb">it</span><span class="p">.</span><span class="na">getDictionary</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;description&quot;</span><span class="p">)</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="w">        </span><span class="p">)</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h3 id="select-specific-properties">Select Specific Properties<a class="headerlink" href="#select-specific-properties" title="Permanent link"></a></h3>
<h4 id="query_1">Query<a class="headerlink" href="#query_1" title="Permanent link"></a></h4>
<p>Here we use <code>SelectResult.property("&lt;property-name&gt;")</code> to specify the document properties we want our query to return â€”
see <a href="#example-20">Example 20</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-20'>Example 20. Query selecting Specific Properties</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">),</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span></code></pre></div>
</div>
<h4 id="result-set-format_1">Result Set Format<a class="headerlink" href="#result-set-format_1" title="Permanent link"></a></h4>
<p>The result set returned when selecting only specific document properties is an array of dictionary objects â€” one for
each document matching the query criteria.</p>
<p>Each result object comprises a key-value pair for each selected document property â€” see <a href="#example-21">Example 21</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-21'>Example 21. Format of Result Set (Specific Properties)</span></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">[</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the first document matching the query criteria.</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel123&quot;</span><span class="p">,</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel&quot;</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hotel Ghia&quot;</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="c1">// The result for the next document matching the query criteria.</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel456&quot;</span><span class="p">,</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel&quot;</span><span class="p">,</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hotel Deluxe&quot;</span><span class="p">,</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="p">]</span>
</span></code></pre></div>
</div>
<h4 id="result-set-access_1">Result Set Access<a class="headerlink" href="#result-set-access_1" title="Permanent link"></a></h4>
<p>Access the retrieved properties by converting each row into a dictionary â€” as shown in <a href="#example-22">Example 22</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-22'>Example 22. Using Returned Document Properties (Specific Properties)</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">allResults</span><span class="p">().</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Hotel name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">, in </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;</span><span class="n">country</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h3 id="select-document-id-only">Select Document ID Only<a class="headerlink" href="#select-document-id-only" title="Permanent link"></a></h3>
<h4 id="query_2">Query<a class="headerlink" href="#query_2" title="Permanent link"></a></h4>
<p>You would typically use this type of query if retrieval of document properties directly would consume excessive amounts
of memory and-or processing time â€” see <a href="#example-23">Example 23</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-23'>Example 23. Query selecting only Doc ID</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">).</span><span class="n">`as`</span><span class="p">(</span><span class="s">&quot;hotelId&quot;</span><span class="p">)</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span></code></pre></div>
</div>
<h4 id="result-set-format_2">Result Set Format<a class="headerlink" href="#result-set-format_2" title="Permanent link"></a></h4>
<p>The result set returned by queries using a <code>SelectResult</code> expression of the form <code>SelectResult.expression(Meta.id)</code> is
an array of dictionary objects â€” one for each document matching the query criteria. Each result object has <code>id</code> as the
key and the ID value as its value â€” see <a href="#example-24">Example 24</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-24'>Example 24. Format of Result Set (Doc ID only)</span></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p">[</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel123&quot;</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hotel456&quot;</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="p">]</span>
</span></code></pre></div>
</div>
<h4 id="result-set-access_2">Result Set Access<a class="headerlink" href="#result-set-access_2" title="Permanent link"></a></h4>
<p>In this case, access the required documentâ€™s properties by unpacking the <code>id</code> and using it to get the document from the
database â€” see <a href="#example-25">Example 25</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-25'>Example 25. Using Returned Document Properties (Document ID)</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">allResults</span><span class="p">().</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">        </span><span class="c1">// Extract the ID value from the dictionary</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">        </span><span class="nb">it</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;hotelId&quot;</span><span class="p">)</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">hotelId</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;hotel id -&gt; </span><span class="si">$</span><span class="n">hotelId</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">            </span><span class="c1">// use the ID to get the document from the database</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">collection</span><span class="p">.</span><span class="na">getDocument</span><span class="p">(</span><span class="n">hotelId</span><span class="p">)</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h3 id="select-count-only">Select Count-only<a class="headerlink" href="#select-count-only" title="Permanent link"></a></h3>
<h4 id="query_3">Query<a class="headerlink" href="#query_3" title="Permanent link"></a></h4>
<div class="admonition example">
<p class="admonition-title"><span id='example-26'>Example 26. Query selecting a Count-only</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Function</span><span class="p">.</span><span class="na">count</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">))).</span><span class="n">`as`</span><span class="p">(</span><span class="s">&quot;mycount&quot;</span><span class="p">)</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span></code></pre></div>
<p>The alias name, <code>mycount</code>, is used to access the count value.</p>
</div>
<h4 id="result-set-format_3">Result Set Format<a class="headerlink" href="#result-set-format_3" title="Permanent link"></a></h4>
<p>The result set returned by a count such as <code>Select.expression(Function.count(Expression.all)))</code> is a key-value pair. The
key is the count name, as defined using <code>SelectResult.as()</code> â€” see <a href="#example-27">Example 27</a> for the format and <a href="#example-26">Example
26</a> for the query.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-27'>Example 27. Format of Result Set (Count)</span></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">  </span><span class="nt">&quot;mycount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="p">}</span>
</span></code></pre></div>
<p>The key-value pair returned by a count.</p>
</div>
<h4 id="result-set-access_3">Result Set Access<a class="headerlink" href="#result-set-access_3" title="Permanent link"></a></h4>
<p>Access the count using its alias name (<code>mycount</code> in this example) â€” see <a href="#example-28">Example 28</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-28'>Example 28. Using Returned Document Properties (Count)</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">allResults</span><span class="p">().</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">        </span><span class="n">printlnt</span><span class="p">(</span><span class="s">&quot;name -&gt; </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;</span><span class="n">mycount</span><span class="s">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="p">}</span>
</span></code></pre></div>
<p>Get the count using the <code>SelectResult.as()</code> alias, which is used as its key.</p>
</div>
<h3 id="handling-pagination">Handling Pagination<a class="headerlink" href="#handling-pagination" title="Permanent link"></a></h3>
<p>One way to handle pagination in high-volume queries is to retrieve the results in batches. Use the limit and offset
feature, to return a defined number of results starting from a given offset â€” see <a href="#example-29">Example 29</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-29'>Example 29. Query Pagination</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">thisOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">thisLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="n">SelectResult</span><span class="p">.</span><span class="na">all</span><span class="p">())</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">    </span><span class="p">.</span><span class="na">limit</span><span class="p">(</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">intValue</span><span class="p">(</span><span class="n">thisLimit</span><span class="p">),</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">        </span><span class="n">Expression</span><span class="p">.</span><span class="na">intValue</span><span class="p">(</span><span class="n">thisOffset</span><span class="p">)</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div>
<p>Return a maximum of limit results starting from result number offset.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <a href="../paging/">Kotbase paging extensions</a> provide a <a href="https://developer.android.com/reference/kotlin/androidx/paging/PagingSource"><code>PagingSource</code></a> to use with <a href="https://developer.android.com/topic/libraries/architecture/paging/v3-overview">AndroidX Paging</a> to assist loading and displaying
pages of data in your app.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For more on using the <code>QueryBuilder</code> API, see our blog: <a href="https://blog.couchbase.com/sql-for-json-query-interface-couchbase-mobile/">Introducing the Query Interface in Couchbase Mobile</a></p>
</div>
<h2 id="json-result-sets">JSON Result Sets<a class="headerlink" href="#json-result-sets" title="Permanent link"></a></h2>
<p>Kotbase provides a convenience API to convert query results to JSON strings.</p>
<p>Use <a href="/api/couchbase-lite-ee/kotbase/-result/to-j-s-o-n.html"><code>Result.toJSON()</code></a> to transform your result into a JSON
string, which can easily be serialized or used as required in your application. See <a href="#example-30">Example 30</a> for a
working example using <a href="https://github.com/Kotlin/kotlinx.serialization">kotlinx-serialization</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-30'>Example 30. Using JSON Results</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1">// Uses kotlinx-serialization JSON processor</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="nd">@Serializable</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Hotel</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="kd">val</span><span class="w"> </span><span class="nv">hotels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mutableListOf</span><span class="o">&lt;</span><span class="n">Hotel</span><span class="o">&gt;</span><span class="p">()</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Meta</span><span class="p">.</span><span class="na">id</span><span class="p">),</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">),</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="w">        </span><span class="n">SelectResult</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="w">    </span><span class="n">rs</span><span class="p">.</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="w">        </span><span class="c1">// Get result as JSON string</span>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">toJSON</span><span class="p">()</span>
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a><span class="w">        </span><span class="c1">// Get JsonObject map from JSON string</span>
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">mapFromJsonString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Json</span><span class="p">.</span><span class="na">decodeFromString</span><span class="o">&lt;</span><span class="n">JsonObject</span><span class="o">&gt;</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a><span class="w">        </span><span class="c1">// Use created JsonObject map</span>
</span><span id="__span-32-25"><a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">hotelId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapFromJsonString</span><span class="o">[</span><span class="s">&quot;id&quot;</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
</span><span id="__span-32-26"><a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">hotelType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapFromJsonString</span><span class="o">[</span><span class="s">&quot;type&quot;</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
</span><span id="__span-32-27"><a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">hotelName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapFromJsonString</span><span class="o">[</span><span class="s">&quot;name&quot;</span><span class="o">]</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
</span><span id="__span-32-28"><a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a>
</span><span id="__span-32-29"><a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a><span class="w">        </span><span class="c1">// Get custom object from JSON string</span>
</span><span id="__span-32-30"><a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a><span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">hotel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Json</span><span class="p">.</span><span class="na">decodeFromString</span><span class="o">&lt;</span><span class="n">Hotel</span><span class="o">&gt;</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
</span><span id="__span-32-31"><a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a><span class="w">        </span><span class="n">hotels</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">hotel</span><span class="p">)</span>
</span><span id="__span-32-32"><a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-33"><a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a><span class="p">}</span>
</span></code></pre></div>
</div>
<h3 id="json-string-format">JSON String Format<a class="headerlink" href="#json-string-format" title="Permanent link"></a></h3>
<p>If your query selects ALL then the JSON format will be:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>{
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>  database-name: {
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>    key1: &quot;value1&quot;,
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>    keyx: &quot;valuex&quot;
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>  }
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>}
</span></code></pre></div>
<p>If your query selects a sub-set of available properties then the JSON format will be:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>{
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>  key1: &quot;value1&quot;,
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>  keyx: &quot;valuex&quot;
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>}
</span></code></pre></div>
<h2 id="predictive-query">Predictive Query<a class="headerlink" href="#predictive-query" title="Permanent link"></a></h2>
<div class="admonition important">
<p class="admonition-title">This is an <a href="https://www.couchbase.com/products/editions/mobile/">Enterprise Edition</a> feature.</p>
</div>
<p>Predictive Query enables Couchbase Lite queries to use machine learning, by providing query functions that can process
document data (properties or blobs) via trained ML models.</p>
<p>Letâ€™s consider an image classifier model that takes a picture as input and outputs a label and probability.</p>
<p><img alt="Predictive Query Diagram" loading="lazy" src="../assets/images/predictive-diagram.png" /></p>
<p>To run a predictive query with a model as the one shown above, you must implement the following steps:</p>
<ol>
<li><a href="#integrate-the-model">Integrate the Model</a></li>
<li><a href="#register-the-model">Register the Model</a></li>
<li><a href="#create-an-index">Create an Index (Optional)</a></li>
<li><a href="#run-a-prediction-query">Run a Prediction Query</a></li>
<li><a href="#deregister-the-model">Deregister the Model</a></li>
</ol>
<h3 id="integrate-the-model">Integrate the Model<a class="headerlink" href="#integrate-the-model" title="Permanent link"></a></h3>
<p>To integrate a model with Couchbase Lite, you must implement the <code>PredictiveModel</code> interface which has only one function
called <code>predict()</code> â€” see <a href="#example-31">Example 31</a>.</p>
<div class="admonition example">
<p class="admonition-title"><span id='example-31'>Example 31. Integrating a predictive model</span></p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">// tensorFlowModel is a fake implementation</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="kd">object</span><span class="w"> </span><span class="nc">TensorFlowModel</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">predictImage</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="n">ByteArray?)</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">Any?</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TODO</span><span class="p">()</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="p">}</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="kd">object</span><span class="w"> </span><span class="nc">ImageClassifierModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PredictiveModel</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ImageClassifier&quot;</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="w">    </span><span class="c1">// this would be the implementation of the ml model you have chosen</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">input</span><span class="p">:</span><span class="w"> </span><span class="n">Dictionary</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">getBlob</span><span class="p">(</span><span class="s">&quot;photo&quot;</span><span class="p">)</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="w">        </span><span class="n">MutableDictionary</span><span class="p">(</span><span class="n">TensorFlowModel</span><span class="p">.</span><span class="na">predictImage</span><span class="p">(</span><span class="nb">it</span><span class="p">.</span><span class="na">content</span><span class="p">))</span><span class="w"> </span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="p">}</span>
</span></code></pre></div>
<p>The <code>predict(input) -&gt; output</code> method provides the input and expects the result of using the machine learning model.
The input and output of the predictive model is a <code>Dictionary</code>. Therefore, the supported data type will be
constrained by the data type that the <code>Dictionary</code> supports.</p>
</div>
<h3 id="register-the-model">Register the Model<a class="headerlink" href="#register-the-model" title="Permanent link"></a></h3>
<p>To register the model you must create a new instance and pass it to the <code>Database.prediction.registerModel()</code> static
method.</p>
<div class="admonition example">
<p class="admonition-title">Example 32. Registering a predictive model</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">Database</span><span class="p">.</span><span class="na">prediction</span><span class="p">.</span><span class="na">registerModel</span><span class="p">(</span><span class="s">&quot;ImageClassifier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageClassifierModel</span><span class="p">)</span>
</span></code></pre></div>
</div>
<h3 id="create-an-index">Create an Index<a class="headerlink" href="#create-an-index" title="Permanent link"></a></h3>
<p>Creating an index for a predictive query is highly recommended. By computing the predictions during writes and building
a prediction index, you can significantly improve the speed of prediction queries (which would otherwise have to be
computed during reads).</p>
<p>There are two types of indexes for predictive queries:</p>
<ul>
<li><a href="#value-index">Value Index</a></li>
<li><a href="#predictive-index">Predictive Index</a></li>
</ul>
<h4 id="value-index">Value Index<a class="headerlink" href="#value-index" title="Permanent link"></a></h4>
<p>The code below creates a value index from the "label" value of the prediction result. When documents are added or
updated, the index will call the prediction function to update the label value in the index.</p>
<div class="admonition example">
<p class="admonition-title">Example 33. Creating a value index</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="n">database</span><span class="p">.</span><span class="na">createIndex</span><span class="p">(</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">    </span><span class="s">&quot;value-index-image-classifier&quot;</span><span class="p">,</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">    </span><span class="n">IndexBuilder</span><span class="p">.</span><span class="na">valueIndex</span><span class="p">(</span><span class="n">ValueIndexItem</span><span class="p">.</span><span class="na">expression</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;label&quot;</span><span class="p">)))</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="p">)</span>
</span></code></pre></div>
</div>
<h4 id="predictive-index">Predictive Index<a class="headerlink" href="#predictive-index" title="Permanent link"></a></h4>
<p>Predictive Index is a new index type used for predictive query. It differs from the value index in that it caches the
predictive results and creates a value index from that cache when the predictive results values are specified.</p>
<div class="admonition example">
<p class="admonition-title">Example 34. Creating a predictive index</p>
<p>Here we create a predictive index from the <code>label</code> value of the prediction result.</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">inputMap</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">Any?</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapOf</span><span class="p">(</span><span class="s">&quot;numbers&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;photo&quot;</span><span class="p">))</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">collection</span><span class="p">.</span><span class="na">createIndex</span><span class="p">(</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="s">&quot;predictive-index-image-classifier&quot;</span><span class="p">,</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">    </span><span class="n">IndexBuilder</span><span class="p">.</span><span class="na">predictiveIndex</span><span class="p">(</span><span class="s">&quot;ImageClassifier&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Expression</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">inputMap</span><span class="p">),</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="p">)</span>
</span></code></pre></div>
</div>
<h3 id="run-a-prediction-query">Run a Prediction Query<a class="headerlink" href="#run-a-prediction-query" title="Permanent link"></a></h3>
<p>The code below creates a query that calls the prediction function to return the "label" value for the first 10 results in the database.</p>
<div class="admonition example">
<p class="admonition-title">Example 35. Creating a value index</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="kd">val</span><span class="w"> </span><span class="nv">inputMap</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="kt">Any?</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapOf</span><span class="p">(</span><span class="s">&quot;photo&quot;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Expression</span><span class="p">.</span><span class="na">property</span><span class="p">(</span><span class="s">&quot;photo&quot;</span><span class="p">))</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="kd">val</span><span class="w"> </span><span class="nv">prediction</span><span class="p">:</span><span class="w"> </span><span class="n">PredictionFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Function</span><span class="p">.</span><span class="na">prediction</span><span class="p">(</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">    </span><span class="n">ImageClassifierModel</span><span class="p">.</span><span class="na">name</span><span class="p">,</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">    </span><span class="n">Expression</span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">inputMap</span><span class="p">)</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="p">)</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="kd">val</span><span class="w"> </span><span class="nv">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QueryBuilder</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">    </span><span class="p">.</span><span class="na">select</span><span class="p">(</span><span class="n">SelectResult</span><span class="p">.</span><span class="na">all</span><span class="p">())</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">    </span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">DataSource</span><span class="p">.</span><span class="na">collection</span><span class="p">(</span><span class="n">collection</span><span class="p">))</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">    </span><span class="p">.</span><span class="na">where</span><span class="p">(</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">        </span><span class="n">prediction</span><span class="p">.</span><span class="na">propertyPath</span><span class="p">(</span><span class="s">&quot;label&quot;</span><span class="p">).</span><span class="na">equalTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">string</span><span class="p">(</span><span class="s">&quot;car&quot;</span><span class="p">))</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">            </span><span class="p">.</span><span class="na">and</span><span class="p">(</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">                </span><span class="n">prediction</span><span class="p">.</span><span class="na">propertyPath</span><span class="p">(</span><span class="s">&quot;probability&quot;</span><span class="p">)</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">                    </span><span class="p">.</span><span class="na">greaterThanOrEqualTo</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="na">doubleValue</span><span class="p">(</span><span class="m">0.8</span><span class="p">))</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">            </span><span class="p">)</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">    </span><span class="p">)</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a><span class="n">query</span><span class="p">.</span><span class="na">execute</span><span class="p">().</span><span class="na">use</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Number of rows: </span><span class="si">${</span><span class="nb">it</span><span class="p">.</span><span class="na">allResults</span><span class="p">().</span><span class="na">size</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a><span class="p">}</span>
</span></code></pre></div>
<p>The <code>PredictiveModel.predict()</code> method returns a constructed <code>PredictionFunction</code> object which can be used further
to specify a property value extracted from the output dictionary of the <code>PredictiveModel.predict()</code> function.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The null value returned by the prediction method will be interpreted as MISSING value in queries.</p>
</div>
<h3 id="deregister-the-model">Deregister the Model<a class="headerlink" href="#deregister-the-model" title="Permanent link"></a></h3>
<p>To deregister the model you must call the <code>Database.prediction.unregisterModel()</code> static method.</p>
<div class="admonition example">
<p class="admonition-title">Example 36. Deregister a value index</p>
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="n">Database</span><span class="p">.</span><span class="na">prediction</span><span class="p">.</span><span class="na">unregisterModel</span><span class="p">(</span><span class="s">&quot;ImageClassifier&quot;</span><span class="p">)</span>
</span></code></pre></div>
</div>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../blobs/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Blobs">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Blobs
              </div>
            </div>
          </a>
        
        
          
          <a href="../n1ql-query-strings/" class="md-footer__link md-footer__link--next" aria-label="Next: SQL++ Query Strings">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                SQL++ Query Strings
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 Jeff Lockhart
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jeffdgr8" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/jeffdgr8" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/lockhartjeff/" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.06 2.06 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065m1.782 13.019H3.555V9h3.564zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.tabs.link", "navigation.footer", "navigation.instant", "navigation.tabs", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "current", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>